(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,78583,e=>{"use strict";e.s(["FileText",()=>t],78583);let t=(0,e.i(75254).default)("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},88844,e=>{"use strict";e.s(["Package",()=>t],88844);let t=(0,e.i(75254).default)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]])},96626,e=>{"use strict";e.s(["Presence",()=>s]);var t=e.i(71645),a=e.i(20783),r=e.i(34620),s=e=>{let{present:s,children:i}=e,l=function(e){var a,s;let[i,l]=t.useState(),o=t.useRef(null),d=t.useRef(e),c=t.useRef("none"),[u,m]=(a=e?"mounted":"unmounted",s={mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}},t.useReducer((e,t)=>{let a=s[e][t];return null!=a?a:e},a));return t.useEffect(()=>{let e=n(o.current);c.current="mounted"===u?e:"none"},[u]),(0,r.useLayoutEffect)(()=>{let t=o.current,a=d.current;if(a!==e){let r=c.current,s=n(t);e?m("MOUNT"):"none"===s||(null==t?void 0:t.display)==="none"?m("UNMOUNT"):a&&r!==s?m("ANIMATION_OUT"):m("UNMOUNT"),d.current=e}},[e,m]),(0,r.useLayoutEffect)(()=>{if(i){var e;let t,a=null!=(e=i.ownerDocument.defaultView)?e:window,r=e=>{let r=n(o.current).includes(CSS.escape(e.animationName));if(e.target===i&&r&&(m("ANIMATION_END"),!d.current)){let e=i.style.animationFillMode;i.style.animationFillMode="forwards",t=a.setTimeout(()=>{"forwards"===i.style.animationFillMode&&(i.style.animationFillMode=e)})}},s=e=>{e.target===i&&(c.current=n(o.current))};return i.addEventListener("animationstart",s),i.addEventListener("animationcancel",r),i.addEventListener("animationend",r),()=>{a.clearTimeout(t),i.removeEventListener("animationstart",s),i.removeEventListener("animationcancel",r),i.removeEventListener("animationend",r)}}m("ANIMATION_END")},[i,m]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:t.useCallback(e=>{o.current=e?getComputedStyle(e):null,l(e)},[])}}(s),o="function"==typeof i?i({present:l.isPresent}):t.Children.only(i),d=(0,a.useComposedRefs)(l.ref,function(e){var t,a;let r=null==(t=Object.getOwnPropertyDescriptor(e.props,"ref"))?void 0:t.get,s=r&&"isReactWarning"in r&&r.isReactWarning;return s?e.ref:(s=(r=null==(a=Object.getOwnPropertyDescriptor(e,"ref"))?void 0:a.get)&&"isReactWarning"in r&&r.isReactWarning)?e.props.ref:e.props.ref||e.ref}(o));return"function"==typeof i||l.isPresent?t.cloneElement(o,{ref:d}):null};function n(e){return(null==e?void 0:e.animationName)||"none"}s.displayName="Presence"},46349,e=>{"use strict";e.s(["default",()=>t]);let t=(0,e.i(75254).default)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},18566,(e,t,a)=>{t.exports=e.r(76562)},48425,e=>{"use strict";e.s(["Primitive",()=>n,"dispatchDiscreteCustomEvent",()=>i]);var t=e.i(71645),a=e.i(74080),r=e.i(91918),s=e.i(43476),n=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,a)=>{let n=(0,r.createSlot)("Primitive.".concat(a)),i=t.forwardRef((e,t)=>{let{asChild:r,...i}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,s.jsx)(r?n:a,{...i,ref:t})});return i.displayName="Primitive.".concat(a),{...e,[a]:i}},{});function i(e,t){e&&a.flushSync(()=>e.dispatchEvent(t))}},64659,e=>{"use strict";e.s(["ChevronDown",()=>t],64659);let t=(0,e.i(75254).default)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},3559,e=>{"use strict";e.s(["FileImage",()=>t],3559);let t=(0,e.i(75254).default)("file-image",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"10",cy:"12",r:"2",key:"737tya"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22",key:"wt3hpn"}]])},61911,e=>{"use strict";e.s(["Users",()=>t],61911);let t=(0,e.i(75254).default)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},39616,e=>{"use strict";e.s(["Settings",()=>t],39616);let t=(0,e.i(75254).default)("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},7486,e=>{"use strict";e.s(["Building2",()=>t],7486);let t=(0,e.i(75254).default)("building-2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]])},21218,e=>{"use strict";e.s(["Activity",()=>t],21218);let t=(0,e.i(75254).default)("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]])},47780,e=>{"use strict";e.s(["Palette",()=>t],47780);let t=(0,e.i(75254).default)("palette",[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]])},33467,e=>{"use strict";e.s(["BarChart",()=>t],33467);let t=(0,e.i(75254).default)("chart-no-axes-column-increasing",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]])},52786,e=>{"use strict";e.s(["HardDrive",()=>t],52786);let t=(0,e.i(75254).default)("hard-drive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]])},92169,e=>{"use strict";e.s(["default",()=>w],92169);var t=e.i(43476),a=e.i(57951),r=e.i(18566),s=e.i(71645),n=e.i(19455),i=e.i(55146),l=e.i(7486),o=e.i(61911),d=e.i(88844),c=e.i(78583),u=e.i(21218),m=e.i(39616),h=e.i(75254);let x=(0,h.default)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),f=(0,h.default)("menu",[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]]);var p=e.i(37727),y=e.i(3559),g=e.i(33467),v=e.i(52786),N=e.i(64659),b=e.i(47780);let k=[{name:"Dasbor",href:"/dashboard",icon:u.Activity,group:"main"},{name:"Aset",href:"/dashboard/assets",icon:d.Package,group:"main",module:"ASSETS"},{name:"Dokumen",href:"/dashboard/documents",icon:c.FileText,group:"main",module:"DOCUMENTS"},{name:"Aset Digital",href:"/dashboard/digital-assets",icon:b.Palette,group:"main",module:"DIGITAL_ASSETS"},{name:"Laporan Arsip",href:"/dashboard/archive-reports",icon:g.BarChart,group:"reports",module:"REPORTS"},{name:"Pengguna",href:"/dashboard/users",icon:o.Users,adminOnly:!0,group:"settings",module:"USERS"},{name:"Kategori",href:"/dashboard/categories",icon:m.Settings,adminOnly:!0,group:"settings",module:"SETTINGS"},{name:"Watermark",href:"/dashboard/watermarks",icon:y.FileImage,adminOnly:!0,group:"settings",module:"SETTINGS"},{name:"Kompresi",href:"/dashboard/compression-stats",icon:v.HardDrive,adminOnly:!0,group:"settings",module:"SETTINGS"},{name:"Log Audit",href:"/dashboard/audit",icon:u.Activity,adminOnly:!0,group:"settings",module:"AUDIT_LOGS"}],j={main:{label:"Operasi Utama",showLabel:!1},reports:{label:"Laporan",showLabel:!0},settings:{label:"Pengaturan",showLabel:!0}};function w(e){let{children:o}=e,{user:d,logout:c,loading:u,token:h}=(0,a.useAuth)(),y=(0,r.useRouter)(),g=(0,r.usePathname)(),[v,b]=(0,s.useState)(!1),[w,M]=(0,s.useState)({}),[A,S]=(0,s.useState)(!1);(0,s.useEffect)(()=>{console.log("DashboardLayout: useEffect - loading:",u,"user:",d),u||d||(console.log("DashboardLayout: Redirecting to login - no user found"),y.push("/login"))},[d,u,y]),(0,s.useEffect)(()=>{d&&"ADMIN"!==d.role&&h&&d.department?E():d&&S(!0)},[d,h]);let E=async()=>{if(!(null==d?void 0:d.department))return void S(!0);try{let e=await fetch("/api/permissions?department=".concat(encodeURIComponent(d.department)),{headers:{Authorization:"Bearer ".concat(h)}});if(e.ok){let t=await e.json(),a={};t.permissions.forEach(e=>{a[e.module]={canRead:e.canRead,canWrite:e.canWrite,canDelete:e.canDelete}}),M(a)}else{console.error("Failed to fetch permissions, status:",e.status);let t=await e.text();console.error("Error details:",t)}}catch(e){console.error("Failed to fetch user permissions:",e)}finally{S(!0)}};if(u||!A)return(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-indigo-600"})});if(!d)return null;let T=k.filter(e=>{var t;return(!e.adminOnly||"ADMIN"===d.role)&&(!(t=e.module)||(null==d?void 0:d.role)==="ADMIN"||!!t&&!!w[t]&&w[t].canRead)}).reduce((e,t)=>{let a=t.group||"main";return e[a]||(e[a]=[]),e[a].push(t),e},{}),O=()=>(0,t.jsx)(t.Fragment,{children:Object.entries(T).map((e,a)=>{var r,s;let[n,i]=e;return(0,t.jsxs)("div",{children:[(null==(r=j[n])?void 0:r.showLabel)&&(0,t.jsx)("div",{className:"px-3 py-2 mt-4 first:mt-0",children:(0,t.jsx)("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:null==(s=j[n])?void 0:s.label})}),i.map(e=>{let a=e.icon;return(0,t.jsxs)("a",{href:e.href,className:"".concat(g===e.href?"bg-[#0EB6B4] text-white border-r-2 border-[#187F7E]":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"," group flex items-center px-3 py-2.5 text-sm font-medium rounded-lg transition-all duration-200"),children:[(0,t.jsx)(a,{className:"mr-3 h-5 w-5"}),e.name]},e.name)}),a<Object.keys(T).length-1&&(0,t.jsx)("div",{className:"my-4 border-t border-gray-200"})]},n)})});return(0,t.jsxs)("div",{className:"min-h-screen",style:{backgroundColor:"var(--color-background)"},children:[(0,t.jsxs)("div",{className:"fixed inset-0 z-50 lg:hidden ".concat(v?"block":"hidden"),children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75",onClick:()=>b(!1)}),(0,t.jsxs)("div",{className:"fixed inset-y-0 left-0 flex w-64 flex-col bg-white shadow-lg",children:[(0,t.jsxs)("div",{className:"flex h-16 items-center justify-between px-4 border-b border-gray-100",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"w-8 h-8 bg-gradient-to-r from-[#187F7E] to-[#00AAA8] rounded-lg flex items-center justify-center",children:(0,t.jsx)(l.Building2,{className:"h-5 w-5 text-white"})}),(0,t.jsx)("span",{className:"ml-2 text-xl font-bold text-gray-900",children:"Orderkuota"})]}),(0,t.jsx)(n.Button,{variant:"ghost",size:"icon",onClick:()=>b(!1),children:(0,t.jsx)(p.X,{className:"h-5 w-5"})})]}),(0,t.jsx)("nav",{className:"flex-1 space-y-1 px-3 py-4",children:O()})]})]}),(0,t.jsx)("div",{className:"hidden lg:fixed lg:inset-y-0 lg:flex lg:w-64 lg:flex-col",children:(0,t.jsxs)("div",{className:"flex flex-col flex-grow bg-white border-r border-gray-100 shadow-sm",children:[(0,t.jsxs)("div",{className:"flex items-center h-16 px-4 border-b border-gray-100",children:[(0,t.jsx)("div",{className:"w-8 h-8 bg-gradient-to-r from-[#187F7E] to-[#00AAA8] rounded-lg flex items-center justify-center",children:(0,t.jsx)(l.Building2,{className:"h-5 w-5 text-white"})}),(0,t.jsx)("span",{className:"ml-2 text-xl font-bold text-gray-900",children:"Orderkuota"})]}),(0,t.jsx)("nav",{className:"flex-1 space-y-1 px-3 py-4",children:O()})]})}),(0,t.jsxs)("div",{className:"lg:pl-64",children:[(0,t.jsxs)("div",{className:"flex h-16 items-center justify-between bg-white px-4 shadow-sm border-b border-gray-100 lg:px-6",children:[(0,t.jsx)(n.Button,{variant:"ghost",size:"icon",className:"lg:hidden",onClick:()=>b(!0),children:(0,t.jsx)(f,{className:"h-6 w-6"})}),(0,t.jsx)("div",{className:"flex-1"}),(0,t.jsxs)(i.DropdownMenu,{children:[(0,t.jsx)(i.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsxs)(n.Button,{variant:"ghost",className:"flex items-center space-x-3 px-3 py-2",children:[(0,t.jsx)("div",{className:"h-8 w-8 rounded-full bg-gradient-to-r from-[#187F7E] to-[#0EB6B4] flex items-center justify-center",children:(0,t.jsxs)("span",{className:"text-sm font-medium text-white",children:[d.firstName.charAt(0),d.lastName.charAt(0)]})}),(0,t.jsxs)("div",{className:"hidden sm:block text-left",children:[(0,t.jsxs)("p",{className:"text-sm font-medium text-gray-700",children:[d.firstName," ",d.lastName]}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:d.role})]}),(0,t.jsx)(N.ChevronDown,{className:"h-4 w-4 text-gray-500"})]})}),(0,t.jsxs)(i.DropdownMenuContent,{align:"end",className:"w-56",children:[(0,t.jsx)(i.DropdownMenuLabel,{children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"text-sm font-medium",children:[d.firstName," ",d.lastName]}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:d.role})]})}),(0,t.jsx)(i.DropdownMenuSeparator,{}),(0,t.jsxs)(i.DropdownMenuItem,{onClick:()=>y.push("/dashboard/settings"),children:[(0,t.jsx)(m.Settings,{className:"mr-2 h-4 w-4"}),"Pengaturan"]}),(0,t.jsx)(i.DropdownMenuSeparator,{}),(0,t.jsxs)(i.DropdownMenuItem,{onClick:()=>{c(),y.push("/login")},className:"text-red-600",children:[(0,t.jsx)(x,{className:"mr-2 h-4 w-4"}),"Keluar"]})]})]})]}),(0,t.jsx)("main",{className:"py-8",children:(0,t.jsx)("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:o})})]})]})}}]);