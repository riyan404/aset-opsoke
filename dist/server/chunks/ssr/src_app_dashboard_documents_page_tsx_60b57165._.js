module.exports=[43448,a=>{"use strict";a.s(["default",()=>A],43448);var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(11642),f=a.i(5193),g=a.i(91119),h=a.i(99570),i=a.i(66718),j=a.i(4720),k=a.i(15618),l=a.i(87532),m=a.i(69012),n=a.i(98876),o=a.i(14574),p=a.i(86304),q=a.i(41675),r=a.i(46842),s=a.i(63910),t=a.i(84505),u=a.i(73570),v=a.i(41710);let w=(0,a.i(70106).default)("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);var x=a.i(20494);function y({documentId:a,isOpen:d,onClose:f,onEdit:g,onDownload:i}){var k,l;let{token:m}=(0,e.useAuth)(),[n,y]=(0,c.useState)(null),[z,A]=(0,c.useState)(!1);(0,c.useEffect)(()=>{a&&d&&B()},[a,d]);let B=async()=>{if(a&&m)try{A(!0);let b=await fetch(`/api/documents/${a}`,{headers:{Authorization:`Bearer ${m}`}});if(b.ok){let a=await b.json();y(a.document)}else console.error("Failed to fetch document details")}catch(a){console.error("Error fetching document details:",a)}finally{A(!1)}},C=a=>new Date(a).toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),D=a=>{if(!a)return!1;let b=new Date(a),c=new Date,d=Math.ceil((b.getTime()-c.getTime())/864e5);return d<=30&&d>0},E=a=>!!a&&new Date(a)<new Date;return d?(0,b.jsx)(o.Dialog,{open:d,onOpenChange:f,children:(0,b.jsxs)(o.DialogContent,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,b.jsx)(o.DialogHeader,{children:(0,b.jsxs)(o.DialogTitle,{className:"flex items-center text-xl",children:[(0,b.jsx)(j.FileText,{className:"w-6 h-6 mr-2 text-green-600"}),"Detail Dokumen"]})}),z?(0,b.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,b.jsx)("div",{className:"w-8 h-8 border-4 border-green-600 border-t-transparent rounded-full animate-spin"})}):n?(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"bg-gray-50 p-6 rounded-lg",children:(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:n.title}),(0,b.jsx)("p",{className:"text-gray-600 mb-4",children:n.description||"Tidak ada deskripsi"}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,b.jsx)(p.Badge,{className:{POLICY:"bg-[#187F7E]/10 text-[#187F7E]",PROCEDURE:"bg-blue-100 text-blue-800",WORK_INSTRUCTION:"bg-green-100 text-green-800",FORM:"bg-yellow-100 text-yellow-800",RECORD:"bg-orange-100 text-orange-800",MANUAL:"bg-indigo-100 text-indigo-800",CERTIFICATE:"bg-pink-100 text-pink-800",CONTRACT:"bg-red-100 text-red-800",CORRESPONDENCE:"bg-teal-100 text-teal-800",OTHER:"bg-gray-100 text-gray-800"}[n.category]||"bg-gray-100 text-gray-800",children:{POLICY:"Kebijakan",PROCEDURE:"Prosedur",WORK_INSTRUCTION:"Instruksi Kerja",FORM:"Formulir",RECORD:"Catatan",MANUAL:"Manual",CERTIFICATE:"Sertifikat",CONTRACT:"Kontrak",CORRESPONDENCE:"Korespondensi",OTHER:"Lainnya"}[k=n.category]||k.replace("_"," ")}),n.subcategory&&(0,b.jsx)(p.Badge,{variant:"outline",children:n.subcategory}),(0,b.jsx)(p.Badge,{variant:n.isActive?"default":"secondary",children:n.isActive?"Aktif":"Tidak Aktif"}),n.expiryDate&&E(n.expiryDate)&&(0,b.jsxs)(p.Badge,{variant:"destructive",children:[(0,b.jsx)(u.AlertTriangle,{className:"w-3 h-3 mr-1"}),"Kedaluwarsa"]}),n.expiryDate&&D(n.expiryDate)&&!E(n.expiryDate)&&(0,b.jsxs)(p.Badge,{variant:"secondary",className:"bg-yellow-100 text-yellow-800",children:[(0,b.jsx)(v.Clock,{className:"w-3 h-3 mr-1"}),"Akan Kedaluwarsa"]})]})]}),(0,b.jsxs)("div",{className:"flex space-x-2",children:[i&&(0,b.jsxs)(h.Button,{onClick:()=>i(n.id,n.fileName),className:"bg-[#187F7E] hover:bg-[#00AAA8]",children:[(0,b.jsx)(t.Download,{className:"w-4 h-4 mr-2"}),"Unduh"]}),g&&(0,b.jsx)(h.Button,{onClick:()=>g(n.id),className:"bg-green-600 hover:bg-green-700",children:"Edit Dokumen"})]})]})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 border-b pb-2",children:"Informasi File"}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(j.FileText,{className:"w-5 h-5 text-gray-400 mr-3"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Nama File"}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:n.fileName})]})]}),(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(x.Database,{className:"w-5 h-5 text-gray-400 mr-3"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Ukuran & Tipe"}),(0,b.jsxs)("p",{className:"text-sm text-gray-600",children:[(a=>{if(0===a)return"0 Bytes";let b=Math.floor(Math.log(a)/Math.log(1024));return parseFloat((a/Math.pow(1024,b)).toFixed(2))+" "+["Bytes","KB","MB","GB"][b]})(n.fileSize)," â€¢ ",n.mimeType]})]})]}),(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(w,{className:"w-5 h-5 text-gray-400 mr-3"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Versi"}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:n.version})]})]}),n.department&&(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(s.Building,{className:"w-5 h-5 text-gray-400 mr-3"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Departemen"}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:n.department})]})]}),n.expiryDate&&(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(q.Calendar,{className:"w-5 h-5 text-gray-400 mr-3"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Tanggal Kedaluwarsa"}),(0,b.jsx)("p",{className:`text-sm ${E(n.expiryDate)?"text-red-600":D(n.expiryDate)?"text-yellow-600":"text-gray-600"}`,children:(l=n.expiryDate)?new Date(l).toLocaleDateString("id-ID"):"-"})]})]})]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 border-b pb-2",children:"Riwayat Dokumen"}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-start",children:[(0,b.jsx)(r.User,{className:"w-5 h-5 text-gray-400 mr-3 mt-0.5"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Dibuat Oleh"}),(0,b.jsxs)("p",{className:"text-sm text-gray-600",children:[n.createdBy.firstName," ",n.createdBy.lastName]}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:n.createdBy.email})]})]}),(0,b.jsxs)("div",{className:"flex items-start",children:[(0,b.jsx)(q.Calendar,{className:"w-5 h-5 text-gray-400 mr-3 mt-0.5"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Tanggal Dibuat"}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:C(n.createdAt)})]})]}),(0,b.jsxs)("div",{className:"flex items-start",children:[(0,b.jsx)(r.User,{className:"w-5 h-5 text-gray-400 mr-3 mt-0.5"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Terakhir Diubah Oleh"}),(0,b.jsxs)("p",{className:"text-sm text-gray-600",children:[n.updatedBy.firstName," ",n.updatedBy.lastName]}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:n.updatedBy.email})]})]}),(0,b.jsxs)("div",{className:"flex items-start",children:[(0,b.jsx)(q.Calendar,{className:"w-5 h-5 text-gray-400 mr-3 mt-0.5"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-900",children:"Terakhir Diubah"}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:C(n.updatedAt)})]})]})]})]})]}),(n.tags||n.watermark)&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 border-b pb-2",children:"Informasi Tambahan"}),n.tags&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-900 mb-2",children:"Tags"}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:(a=>{if(!a)return[];try{return JSON.parse(a)}catch{return a.split(",").map(a=>a.trim())}})(n.tags).map((a,c)=>(0,b.jsx)(p.Badge,{variant:"outline",className:"text-xs",children:a},c))})]}),n.watermark&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-900 mb-2",children:"Watermark"}),(0,b.jsx)("p",{className:"text-sm text-gray-600 bg-gray-50 p-3 rounded-md font-mono",children:n.watermark})]})]})]}):(0,b.jsx)("div",{className:"text-center py-8",children:(0,b.jsx)("p",{className:"text-gray-500",children:"Dokumen tidak ditemukan"})})]})}):null}var z=a.i(35007);function A(){let{token:a}=(0,e.useAuth)(),{showSuccess:o,showError:p}=(0,f.useNotification)(),q=(0,d.useRouter)(),[r,s]=(0,c.useState)([]),[t,u]=(0,c.useState)(!0),[v,w]=(0,c.useState)(""),[x,A]=(0,c.useState)(1),[B,C]=(0,c.useState)(1),[D,E]=(0,c.useState)(0),[F,G]=(0,c.useState)(null),[H,I]=(0,c.useState)(!1),[J,K]=(0,c.useState)({isOpen:!1,document:null,loading:!1});(0,c.useEffect)(()=>{L()},[x,v]);let L=async()=>{try{u(!0);let b=new URLSearchParams({page:x.toString(),limit:"10",...v&&{search:v}}),c=await fetch(`/api/documents?${b}`,{headers:{Authorization:`Bearer ${a}`}});if(c.ok){let a=await c.json();s(a.documents),C(a.pagination.pages),E(a.pagination.total)}}catch(a){console.error("Failed to fetch documents:",a)}finally{u(!1)}},M=a=>a?new Date(a).toLocaleDateString("id-ID"):"-",N=async(b,c)=>{try{let d=await fetch(`/api/documents/${b}/download`,{headers:{Authorization:`Bearer ${a}`}});if(d.ok){let a=await d.blob(),b=window.URL.createObjectURL(a),e=document.createElement("a");e.href=b,e.download=c,document.body.appendChild(e),e.click(),window.URL.revokeObjectURL(b),document.body.removeChild(e)}}catch(a){console.error("Failed to download document:",a)}},O=a=>{G(a),I(!0)},P=a=>{q.push(`/dashboard/documents/${a}/edit`)},Q=async(b,c)=>{try{let c=await fetch(`/api/documents/${b}/share`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({expiresIn:72})});if(c.ok){let a=await c.json();navigator.clipboard.writeText(a.shareUrl),o(`Link berbagi berhasil dibuat dan disalin ke clipboard!
Link akan kedaluwarsa pada: ${new Date(a.expiresAt).toLocaleString("id-ID")}`)}else{let a=await c.json();p(a.error||"Gagal membuat link berbagi")}}catch(a){console.error("Error sharing document:",a),p("Gagal membuat link berbagi")}},R=async b=>{let c=prompt("Alasan mengarsipkan dokumen:");if(null!==c)try{let d=await fetch(`/api/documents/${b}/archive`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({reason:c})});if(d.ok)L(),o("Dokumen berhasil diarsipkan");else{let a=await d.json();p(a.error||"Gagal mengarsipkan dokumen")}}catch(a){console.error("Error archiving document:",a),p("Gagal mengarsipkan dokumen")}},S=a=>{K({isOpen:!0,document:a,loading:!1})},T=async()=>{if(J.document){K(a=>({...a,loading:!0}));try{let b=await fetch(`/api/documents/${J.document.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${a}`}});if(b.ok)L(),K({isOpen:!1,document:null,loading:!1}),o("Dokumen berhasil dihapus");else{let a=await b.json();p(a.error||"Gagal menghapus dokumen")}}catch(a){console.error("Error deleting document:",a),p("Gagal menghapus dokumen")}finally{K(a=>({...a,loading:!1}))}}};return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Arsip Dokumen"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Kelola dokumen perusahaan Anda mengikuti standar ISO"})]}),(0,b.jsxs)(h.Button,{className:"bg-green-600 hover:bg-green-700",onClick:()=>q.push("/dashboard/documents/upload"),children:[(0,b.jsx)(k.Plus,{className:"w-4 h-4 mr-2"}),"Unggah Dokumen"]})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsx)(g.CardHeader,{children:(0,b.jsxs)(g.CardTitle,{className:"flex items-center",children:[(0,b.jsx)(m.Filter,{className:"w-5 h-5 mr-2"}),"Filter"]})}),(0,b.jsx)(g.CardContent,{children:(0,b.jsxs)("div",{className:"flex gap-4",children:[(0,b.jsx)("div",{className:"flex-1",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(l.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,b.jsx)(i.Input,{placeholder:"Cari dokumen...",value:v,onChange:a=>w(a.target.value),className:"pl-10"})]})}),(0,b.jsxs)(h.Button,{variant:"outline",children:[(0,b.jsx)(m.Filter,{className:"w-4 h-4 mr-2"}),"Kategori"]})]})})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsxs)(g.CardTitle,{className:"flex items-center",children:[(0,b.jsx)(j.FileText,{className:"w-5 h-5 mr-2"}),"Dokumen (",D,")"]}),(0,b.jsxs)(g.CardDescription,{children:["Menampilkan ",r.length," dari ",D," dokumen"]})]}),(0,b.jsx)(g.CardContent,{children:t?(0,b.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,b.jsx)("div",{className:"w-8 h-8 border-4 border-green-600 border-t-transparent rounded-full animate-spin"})}):0===r.length?(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)(j.FileText,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-gray-500",children:"Tidak ada dokumen ditemukan"})]}):(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-12 gap-4 px-4 py-3 bg-gray-50 rounded-lg font-medium text-sm text-gray-700",children:[(0,b.jsx)("div",{className:"col-span-4",children:"Dokumen"}),(0,b.jsx)("div",{className:"col-span-2",children:"Kategori"}),(0,b.jsx)("div",{className:"col-span-2",children:"Ukuran"}),(0,b.jsx)("div",{className:"col-span-2",children:"Dibuat"}),(0,b.jsx)("div",{className:"col-span-2",children:"Aksi"})]}),r.map(a=>{var c;return(0,b.jsxs)("div",{className:"grid grid-cols-12 gap-4 px-4 py-4 border border-gray-200 rounded-lg hover:bg-gray-50",children:[(0,b.jsx)("div",{className:"col-span-4",children:(0,b.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,b.jsx)("div",{className:"flex-shrink-0 w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center",children:(0,b.jsx)(j.FileText,{className:"w-5 h-5 text-red-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-medium text-gray-900",children:a.title}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:a.fileName}),a.description&&(0,b.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:a.description}),(0,b.jsxs)("div",{className:"flex items-center space-x-2 mt-1",children:[(0,b.jsxs)("span",{className:"text-xs text-gray-500",children:["v",a.version]}),a.expiryDate&&(0,b.jsxs)("span",{className:"text-xs text-orange-600",children:["Kedaluwarsa: ",M(a.expiryDate)]})]})]})]})}),(0,b.jsxs)("div",{className:"col-span-2",children:[(0,b.jsx)("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${{POLICY:"bg-[#187F7E]/10 text-[#187F7E]",PROCEDURE:"bg-blue-100 text-blue-800",WORK_INSTRUCTION:"bg-green-100 text-green-800",FORM:"bg-yellow-100 text-yellow-800",RECORD:"bg-orange-100 text-orange-800",MANUAL:"bg-indigo-100 text-indigo-800",CERTIFICATE:"bg-pink-100 text-pink-800",CONTRACT:"bg-red-100 text-red-800",CORRESPONDENCE:"bg-teal-100 text-teal-800",OTHER:"bg-gray-100 text-gray-800"}[a.category]||"bg-gray-100 text-gray-800"}`,children:{POLICY:"Kebijakan",PROCEDURE:"Prosedur",WORK_INSTRUCTION:"Instruksi Kerja",FORM:"Formulir",RECORD:"Catatan",MANUAL:"Manual",CERTIFICATE:"Sertifikat",CONTRACT:"Kontrak",CORRESPONDENCE:"Korespondensi",OTHER:"Lainnya"}[c=a.category]||c.replace("_"," ")}),a.subcategory&&(0,b.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:a.subcategory})]}),(0,b.jsxs)("div",{className:"col-span-2",children:[(0,b.jsx)("p",{className:"font-medium text-gray-900",children:(a=>{if(0===a)return"0 Bytes";let b=Math.floor(Math.log(a)/Math.log(1024));return parseFloat((a/Math.pow(1024,b)).toFixed(2))+" "+["Bytes","KB","MB","GB"][b]})(a.fileSize)}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:a.mimeType})]}),(0,b.jsxs)("div",{className:"col-span-2",children:[(0,b.jsx)("p",{className:"font-medium text-gray-900",children:M(a.createdAt)}),(0,b.jsxs)("p",{className:"text-sm text-gray-500",children:["oleh ",a.createdBy.firstName," ",a.createdBy.lastName]})]}),(0,b.jsx)("div",{className:"col-span-2",children:(0,b.jsx)(n.ActionsDropdown,{items:(0,n.documentActions)(a,O,P,N,Q,R,S)})})]},a.id)}),B>1&&(0,b.jsxs)("div",{className:"flex items-center justify-between pt-4",children:[(0,b.jsxs)("p",{className:"text-sm text-gray-600",children:["Halaman ",x," dari ",B]}),(0,b.jsxs)("div",{className:"flex space-x-2",children:[(0,b.jsx)(h.Button,{variant:"outline",size:"sm",onClick:()=>A(a=>Math.max(1,a-1)),disabled:1===x,children:"Sebelumnya"}),(0,b.jsx)(h.Button,{variant:"outline",size:"sm",onClick:()=>A(a=>Math.min(B,a+1)),disabled:x===B,children:"Selanjutnya"})]})]})]})})]}),(0,b.jsx)(y,{documentId:F,isOpen:H,onClose:()=>{I(!1),G(null)},onEdit:P,onDownload:N}),(0,b.jsx)(z.DeleteConfirmationModal,{isOpen:J.isOpen,onClose:()=>K({isOpen:!1,document:null,loading:!1}),onConfirm:T,title:"Hapus Dokumen",message:"Apakah Anda yakin ingin menghapus dokumen ini? Tindakan ini tidak dapat dibatalkan.",itemName:J.document?.title,loading:J.loading})]})}}];

//# sourceMappingURL=src_app_dashboard_documents_page_tsx_60b57165._.js.map